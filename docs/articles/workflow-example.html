<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="RRatepol">
<title>Example of full workflow • RRatepol</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Example of full workflow">
<meta property="og:description" content="RRatepol">
<meta property="og:image" content="https://hope-uib-bio.github.io/R-Ratepol-package/reference/figures/RRatepol_logo.png">
<meta property="og:image:alt" content="The original sketch for logo was done by Vanesa Surtkova">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@OndrejMottl">
<meta name="twitter:site" content="@OndrejMottl">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">RRatepol</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/package-description.html">General RRatepol package description</a>
    <a class="dropdown-item" href="../articles/workflow-example.html">Example of full workflow</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/HOPE-UIB-BIO/R-Ratepol-package/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Example of full workflow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/HOPE-UIB-BIO/R-Ratepol-package/blob/HEAD/vignettes/workflow-example.Rmd" class="external-link"><code>vignettes/workflow-example.Rmd</code></a></small>
      <div class="d-none name"><code>workflow-example.Rmd</code></div>
    </div>

    
    
<p>This workflow should show the full strength of the <em>RRatepol
package</em> and serve as step-by-step guidance starting from
downloading dataset from Neotoma, building age-depth models, to
estimating rate-of-change using age uncertainty.</p>
<p>⚠️<strong>This workflow is only meant as an example</strong>: There
are several additional steps for data preparation, which should be done
to properly implement RRatepol and assess the rate of change of a fossil
pollen dataset from Neotoma!</p>
<p>For an even more detailed step-by-step workflow with fossil pollen
data, please see other package materials, such as <a href="https://ondrejmottl.github.io/APD_R-Ratepol_workshop/index.html" class="external-link">African
Polled Database workshop</a>.</p>
<p>Additionally, please see <a href="https://hope-uib-bio.github.io/FOSSILPOL-website/" class="external-link"><strong>FOSSILPOL</strong></a>,
an R-based modular workflow to process multiple fossil pollen records to
create a comprehensive, standardized dataset compilation, ready for
multi-record and multi-proxy analyses at various spatial and temporal
scales.</p>
<p>Finally, for workflows using other data types (e.g., geochemistry and
XRF), see <a href="https://ondrejmottl.github.io/OCCR_R-Ratepol_workshop/" class="external-link">Oeschger
Centre for Climate Change Research Workshop</a>.</p>
<div class="section level2">
<h2 id="install-packages">Install packages<a class="anchor" aria-label="anchor" href="#install-packages"></a>
</h2>
<p>Make a list of packages needed from CRAN</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">package_list</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"tidyverse"</span>, <span class="co"># general data wrangling and visualisation</span></span>
<span>    <span class="st">"neotoma2"</span>, <span class="co"># access to the Neotoma database</span></span>
<span>    <span class="st">"pander"</span>, <span class="co"># nice tables</span></span>
<span>    <span class="st">"Bchron"</span>, <span class="co"># age-depth modelling</span></span>
<span>    <span class="st">"janitor"</span>, <span class="co"># string cleaning</span></span>
<span>    <span class="st">"remotes"</span> <span class="co"># installing packages from GitHub</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Install all packages from CRAN</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>  <span class="va">package_list</span>, <span class="fu">utils</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="attach-packages">Attach packages<a class="anchor" aria-label="anchor" href="#attach-packages"></a>
</h2>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span> <span class="co"># general data wrangling and visualisation</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rapporter.github.io/pander/" class="external-link">pander</a></span><span class="op">)</span> <span class="co"># nice tables</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HOPE-UIB-BIO/R-Ratepol-package" class="external-link">RRatepol</a></span><span class="op">)</span> <span class="co"># rate-of-vegetation change</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/NeotomaDB/neotoma2" class="external-link">neotoma2</a></span><span class="op">)</span> <span class="co"># obtain data from the Neotoma database</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://andrewcparnell.github.io/Bchron/" class="external-link">Bchron</a></span><span class="op">)</span> <span class="co"># age-depth modeling</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor" class="external-link">janitor</a></span><span class="op">)</span> <span class="co"># string cleaning</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="download-the-dataset-glendalough-valley-from-neotoma">Download the dataset <em>Glendalough Valley</em> from Neotoma<a class="anchor" aria-label="anchor" href="#download-the-dataset-glendalough-valley-from-neotoma"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gl_dataset_download</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">neotoma2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/neotoma2/man/get_downloads.html" class="external-link">get_downloads</a></span><span class="op">(</span><span class="fl">17334</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="prepare-the-pollen-counts">Prepare the pollen counts<a class="anchor" aria-label="anchor" href="#prepare-the-pollen-counts"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get samples</span></span>
<span><span class="va">gl_counts</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">neotoma2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/neotoma2/man/samples.html" class="external-link">samples</a></span><span class="op">(</span><span class="va">gl_dataset_download</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select only "pollen" taxa</span></span>
<span><span class="va">gl_taxon_list_selected</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">neotoma2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/neotoma2/man/taxa.html" class="external-link">taxa</a></span><span class="op">(</span><span class="va">gl_dataset_download</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">element</span> <span class="op">==</span> <span class="st">"pollen"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html" class="external-link">pluck</a></span><span class="op">(</span><span class="st">"variablename"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># prepare taxa table</span></span>
<span><span class="va">gl_counts_selected</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">gl_counts</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sample_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">sampleid</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"sample_id"</span>, <span class="st">"value"</span>, <span class="st">"variablename"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># only include selected taxons</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="va">variablename</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">gl_taxon_list_selected</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># turn into the wider format</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="st">"variablename"</span>,</span>
<span>    values_from <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>    values_fill <span class="op">=</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># clean names</span></span>
<span>  <span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html" class="external-link">clean_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gl_counts_selected</span><span class="op">)</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span></span></code></pre></div>
<table style="width:85%;" class="table">
<colgroup>
<col width="16%">
<col width="11%">
<col width="22%">
<col width="19%">
<col width="15%">
</colgroup>
<thead><tr class="header">
<th align="center">sample_id</th>
<th align="center">larix</th>
<th align="center">cichorioideae</th>
<th align="center">prunus_type</th>
<th align="center">apiaceae</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">161508</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">161509</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">161510</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">161511</td>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">161512</td>
<td align="center">0</td>
<td align="center">2</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">161513</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>Here, we strongly advocate that attention should be paid to the
selection of the ecological groups as well as the harmonisation of the
pollen taxa. However, that is not the subject of this workflow, but any
analysis to be published needs careful preparation of the fossil pollen
datasets before using R-Ratepol!</p>
</div>
<div class="section level2">
<h2 id="preparation-of-the-levels">Preparation of the levels<a class="anchor" aria-label="anchor" href="#preparation-of-the-levels"></a>
</h2>
<div class="section level3">
<h3 id="sample-depth">Sample depth<a class="anchor" aria-label="anchor" href="#sample-depth"></a>
</h3>
<p>Extract depth for each level</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gl_level</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">neotoma2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/neotoma2/man/samples.html" class="external-link">samples</a></span><span class="op">(</span><span class="va">gl_dataset_download</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>sample_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">sampleid</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">sample_id</span>, <span class="va">depth</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">sample_id</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gl_level</span><span class="op">)</span></span></code></pre></div>
<table style="width:28%;" class="table">
<colgroup>
<col width="16%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="center">sample_id</th>
<th align="center">depth</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">161508</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">161509</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="center">161510</td>
<td align="center">16</td>
</tr>
<tr class="even">
<td align="center">161511</td>
<td align="center">24</td>
</tr>
<tr class="odd">
<td align="center">161512</td>
<td align="center">32</td>
</tr>
<tr class="even">
<td align="center">161513</td>
<td align="center">40</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="age-depth-modelling">Age depth modelling<a class="anchor" aria-label="anchor" href="#age-depth-modelling"></a>
</h3>
<p>e will recalculate the age-depth model ‘de novo’ using the <a href="http://andrewcparnell.github.io/Bchron/" class="external-link"><em>Bchron</em>
package</a>.</p>
<div class="section level4">
<h4 id="prepare-chron-control-table-and-run-bchron">Prepare chron.control table and run Bchron<a class="anchor" aria-label="anchor" href="#prepare-chron-control-table-and-run-bchron"></a>
</h4>
<p>The chronology control table contains all the dates (mostly
radiocarbon) to create the age-depth model.</p>
<p>Here we only present a few of the important steps of preparation of
the chronology control table. There are many more potential issues, but
solving those is not the focus of this workflow.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># First, get the chronologies and check which we want to use used</span></span>
<span><span class="va">gl_chron_control_table_download</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">neotoma2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/neotoma2/man/chroncontrols.html" class="external-link">chroncontrols</a></span><span class="op">(</span><span class="va">gl_dataset_download</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gl_chron_control_table_download</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="11%">
<col width="19%">
<col width="10%">
<col width="15%">
<col width="20%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th align="center">siteid</th>
<th align="center">chronologyid</th>
<th align="center">depth</th>
<th align="center">thickness</th>
<th align="center">agelimitolder</th>
<th align="center">chroncontrolid</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">11577</td>
<td align="center">9691</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">-45</td>
<td align="center">37155</td>
</tr>
<tr class="even">
<td align="center">11577</td>
<td align="center">9691</td>
<td align="center">210</td>
<td align="center">3</td>
<td align="center">1710</td>
<td align="center">37156</td>
</tr>
<tr class="odd">
<td align="center">11577</td>
<td align="center">9691</td>
<td align="center">426</td>
<td align="center">4</td>
<td align="center">2340</td>
<td align="center">37157</td>
</tr>
<tr class="even">
<td align="center">11577</td>
<td align="center">9691</td>
<td align="center">630</td>
<td align="center">4</td>
<td align="center">2530</td>
<td align="center">37158</td>
</tr>
<tr class="odd">
<td align="center">11577</td>
<td align="center">9691</td>
<td align="center">1056</td>
<td align="center">3</td>
<td align="center">4090</td>
<td align="center">37159</td>
</tr>
<tr class="even">
<td align="center">11577</td>
<td align="center">9691</td>
<td align="center">1105</td>
<td align="center">4</td>
<td align="center">4510</td>
<td align="center">37160</td>
</tr>
</tbody>
</table>
<table style="width:76%;" class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="26%">
</colgroup>
<thead><tr class="header">
<th align="center">agelimityounger</th>
<th align="center">chroncontrolage</th>
<th align="center">chroncontroltype</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">-45</td>
<td align="center">-45</td>
<td align="center">Core top</td>
</tr>
<tr class="even">
<td align="center">1590</td>
<td align="center">1650</td>
<td align="center">Radiocarbon</td>
</tr>
<tr class="odd">
<td align="center">2280</td>
<td align="center">2310</td>
<td align="center">Radiocarbon</td>
</tr>
<tr class="even">
<td align="center">2470</td>
<td align="center">2500</td>
<td align="center">Radiocarbon</td>
</tr>
<tr class="odd">
<td align="center">4030</td>
<td align="center">4060</td>
<td align="center">Radiocarbon</td>
</tr>
<tr class="even">
<td align="center">4410</td>
<td align="center">4460</td>
<td align="center">Radiocarbon</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare the table</span></span>
<span><span class="va">gl_chron_control_table</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">gl_chron_control_table_download</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">chronologyid</span> <span class="op">==</span> <span class="fl">9691</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># Here we calculate the error as the average of the age `limitolder` and</span></span>
<span>  <span class="co">#   `agelimityounger`</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="op">(</span><span class="va">agelimitolder</span> <span class="op">-</span> <span class="va">agelimityounger</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># As Bchron cannot accept a error of 0, we need to replace the value with 1</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/replace.html" class="external-link">replace</a></span><span class="op">(</span><span class="va">error</span>, <span class="va">error</span> <span class="op">==</span> <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">error</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">error</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="co"># We need to specify which calibration curve should be used for what point</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    curve <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">gl_dataset_download</span><span class="op">)</span><span class="op">[</span><span class="st">"lat"</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="st">"intcal20"</span>, <span class="st">"shcal20"</span><span class="op">)</span>,</span>
<span>    curve <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">chroncontroltype</span> <span class="op">!=</span> <span class="st">"Radiocarbon"</span>, <span class="st">"normal"</span>, <span class="va">curve</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">column_to_rownames</a></span><span class="op">(</span><span class="st">"chroncontrolid"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>    <span class="va">chroncontrolage</span>, <span class="va">error</span>, <span class="va">depth</span>, <span class="va">thickness</span>, <span class="va">chroncontroltype</span>, <span class="va">curve</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gl_chron_control_table</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Table continues below</caption>
<colgroup>
<col width="15%">
<col width="23%">
<col width="10%">
<col width="10%">
<col width="15%">
<col width="24%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">chroncontrolage</th>
<th align="center">error</th>
<th align="center">depth</th>
<th align="center">thickness</th>
<th align="center">chroncontroltype</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>37155</strong></td>
<td align="center">-45</td>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">Core top</td>
</tr>
<tr class="even">
<td align="center"><strong>37156</strong></td>
<td align="center">1650</td>
<td align="center">60</td>
<td align="center">210</td>
<td align="center">3</td>
<td align="center">Radiocarbon</td>
</tr>
<tr class="odd">
<td align="center"><strong>37157</strong></td>
<td align="center">2310</td>
<td align="center">30</td>
<td align="center">426</td>
<td align="center">4</td>
<td align="center">Radiocarbon</td>
</tr>
<tr class="even">
<td align="center"><strong>37158</strong></td>
<td align="center">2500</td>
<td align="center">30</td>
<td align="center">630</td>
<td align="center">4</td>
<td align="center">Radiocarbon</td>
</tr>
<tr class="odd">
<td align="center"><strong>37159</strong></td>
<td align="center">4060</td>
<td align="center">30</td>
<td align="center">1056</td>
<td align="center">3</td>
<td align="center">Radiocarbon</td>
</tr>
<tr class="even">
<td align="center"><strong>37160</strong></td>
<td align="center">4460</td>
<td align="center">50</td>
<td align="center">1105</td>
<td align="center">4</td>
<td align="center">Radiocarbon</td>
</tr>
</tbody>
</table>
<table style="width:33%;" class="table">
<colgroup>
<col width="16%">
<col width="16%">
</colgroup>
<thead><tr class="header">
<th align="center"> </th>
<th align="center">curve</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><strong>37155</strong></td>
<td align="center">normal</td>
</tr>
<tr class="even">
<td align="center"><strong>37156</strong></td>
<td align="center">intcal20</td>
</tr>
<tr class="odd">
<td align="center"><strong>37157</strong></td>
<td align="center">intcal20</td>
</tr>
<tr class="even">
<td align="center"><strong>37158</strong></td>
<td align="center">intcal20</td>
</tr>
<tr class="odd">
<td align="center"><strong>37159</strong></td>
<td align="center">intcal20</td>
</tr>
<tr class="even">
<td align="center"><strong>37160</strong></td>
<td align="center">intcal20</td>
</tr>
</tbody>
</table>
<p>As this is just a toy example, we will use only the iteration
multiplier (<code>i_multiplier</code>) of <code>0.1</code> to reduce the
computation time. However, we strongly recommend increasing it to 5 for
any normal age-depth model construction.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">i_multiplier</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># increase to 5</span></span>
<span></span>
<span><span class="co"># Those are default values suggested by the Bchron package</span></span>
<span><span class="va">n_iteration_default</span> <span class="op">&lt;-</span> <span class="fl">10e3</span></span>
<span><span class="va">n_burn_default</span> <span class="op">&lt;-</span> <span class="fl">2e3</span></span>
<span><span class="va">n_thin_default</span> <span class="op">&lt;-</span> <span class="fl">8</span></span>
<span></span>
<span><span class="co"># Let's multiply them by our i_multiplier</span></span>
<span><span class="va">n_iteration</span> <span class="op">&lt;-</span> <span class="va">n_iteration_default</span> <span class="op">*</span> <span class="va">i_multiplier</span></span>
<span><span class="va">n_burn</span> <span class="op">&lt;-</span> <span class="va">n_burn_default</span> <span class="op">*</span> <span class="va">i_multiplier</span></span>
<span><span class="va">n_thin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n_thin_default</span> <span class="op">*</span> <span class="va">i_multiplier</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gl_bchron</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">Bchron</span><span class="fu">::</span><span class="fu"><a href="https://andrewcparnell.github.io/Bchron/reference/Bchronology.html" class="external-link">Bchronology</a></span><span class="op">(</span></span>
<span>    ages <span class="op">=</span> <span class="va">gl_chron_control_table</span><span class="op">$</span><span class="va">chroncontrolage</span>,</span>
<span>    ageSds <span class="op">=</span> <span class="va">gl_chron_control_table</span><span class="op">$</span><span class="va">error</span>,</span>
<span>    positions <span class="op">=</span> <span class="va">gl_chron_control_table</span><span class="op">$</span><span class="va">depth</span>,</span>
<span>    calCurves <span class="op">=</span> <span class="va">gl_chron_control_table</span><span class="op">$</span><span class="va">curve</span>,</span>
<span>    positionThicknesses <span class="op">=</span> <span class="va">gl_chron_control_table</span><span class="op">$</span><span class="va">thickness</span>,</span>
<span>    iterations <span class="op">=</span> <span class="va">n_iteration</span>,</span>
<span>    burn <span class="op">=</span> <span class="va">n_burn</span>,</span>
<span>    thin <span class="op">=</span> <span class="va">n_thin</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Visually check the age-depth models</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gl_bchron</span><span class="op">)</span></span></code></pre></div>
<p><img src="workflow-example_files/figure-html/bchron_figure-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="predict-ages">Predict ages<a class="anchor" aria-label="anchor" href="#predict-ages"></a>
</h4>
<p>Let’s first extract posterior ages from the age-depth model
(i.e. possible ages)</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">age_position</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">Bchron</span><span class="fu">:::</span><span class="fu"><a href="https://andrewcparnell.github.io/Bchron/reference/predict.BchronologyRun.html" class="external-link">predict.BchronologyRun</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">gl_bchron</span>, newPositions <span class="op">=</span> <span class="va">gl_level</span><span class="op">$</span><span class="va">depth</span><span class="op">)</span></span>
<span></span>
<span><span class="va">age_uncertainties</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">age_position</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html" class="external-link">mutate_all</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">as.integer</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">age_uncertainties</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">gl_level</span><span class="op">$</span><span class="va">sample_id</span></span>
<span></span>
<span><span class="va">gl_level_predicted</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">gl_level</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span></span>
<span>      <span class="va">age_uncertainties</span>, <span class="fl">2</span>,</span>
<span>      <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span>,</span>
<span>      probs <span class="op">=</span> <span class="fl">0.5</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gl_level_predicted</span><span class="op">)</span></span></code></pre></div>
<table style="width:39%;" class="table">
<colgroup>
<col width="16%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="center">sample_id</th>
<th align="center">depth</th>
<th align="center">age</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">161508</td>
<td align="center">0</td>
<td align="center">-45</td>
</tr>
<tr class="even">
<td align="center">161509</td>
<td align="center">8</td>
<td align="center">15</td>
</tr>
<tr class="odd">
<td align="center">161510</td>
<td align="center">16</td>
<td align="center">75</td>
</tr>
<tr class="even">
<td align="center">161511</td>
<td align="center">24</td>
<td align="center">135</td>
</tr>
<tr class="odd">
<td align="center">161512</td>
<td align="center">32</td>
<td align="center">195</td>
</tr>
<tr class="even">
<td align="center">161513</td>
<td align="center">40</td>
<td align="center">254.5</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 id="estimation-rate-of-change">Estimation Rate-of-Change<a class="anchor" aria-label="anchor" href="#estimation-rate-of-change"></a>
</h2>
<p>Here we use the the prepared data to estimate the rate of vegetation
change. We will be using the <em>Chi-squared coefficient</em> as the
dissimilarity coefficient (works best for pollen data,
<code>dissimilarity_coefficient</code> = <code>"chisq"</code>), and
<code>time_standardisation</code> == 500 (this means that all ROC values
are ‘change per 500 yr’). We will add smoothing of the pollen data using
<code>smooth_method</code> = <code>"shep"</code> (i.e. <em>Shepard’s
5-term filter</em>). Finally, we will use the method of the “<em>binning
with the mowing window</em>” (<code>working_units</code> =
<code>"MW"</code>). This is again a toy example for a quick computation
and we would recommend increasing the <em>set_randomisations</em> to
10.000 for any real estimation.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">set_randomisations</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># increase to 10e3</span></span>
<span></span>
<span><span class="va">gl_roc</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">RRatepol</span><span class="fu">::</span><span class="fu"><a href="../reference/estimate_roc.html">estimate_roc</a></span><span class="op">(</span></span>
<span>    data_source_community <span class="op">=</span> <span class="va">gl_counts_selected</span>,</span>
<span>    data_source_age <span class="op">=</span> <span class="va">gl_level_predicted</span>,</span>
<span>    age_uncertainty <span class="op">=</span> <span class="va">age_uncertainties</span>, <span class="co"># Add the uncertainty matrix</span></span>
<span>    smooth_method <span class="op">=</span> <span class="st">"shep"</span>, <span class="co"># Shepard's 5-term filter</span></span>
<span>    dissimilarity_coefficient <span class="op">=</span> <span class="st">"chisq"</span>,</span>
<span>    working_units <span class="op">=</span> <span class="st">"MW"</span>, <span class="co"># set to "MW" to apply the "moving window"</span></span>
<span>    bin_size <span class="op">=</span> <span class="fl">500</span>, <span class="co"># size of a time bin</span></span>
<span>    number_of_shifts <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    standardise <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># set the taxa standardisation</span></span>
<span>    n_individuals <span class="op">=</span> <span class="fl">150</span>, <span class="co"># set the number of pollen grains</span></span>
<span>    rand <span class="op">=</span> <span class="va">set_randomisations</span>, <span class="co"># set number of randomisations</span></span>
<span>    use_parallel <span class="op">=</span> <span class="cn">FALSE</span> <span class="co"># use_parallel = TRUE to use parallel calculation</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="detect-peak-points-and-plot-the-results">Detect peak-points and plot the results<a class="anchor" aria-label="anchor" href="#detect-peak-points-and-plot-the-results"></a>
</h3>
<p>We will detect a significant increase in RoC values
(i.e. <em>peak-points</em>). Specifically, we will use the “Non-linear”
method, which will detect significant change from a non-linear trend of
RoC</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gl_roc_peaks</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">RRatepol</span><span class="fu">::</span><span class="fu"><a href="../reference/detect_peak_points.html">detect_peak_points</a></span><span class="op">(</span></span>
<span>    data_source <span class="op">=</span> <span class="va">gl_roc</span>,</span>
<span>    sel_method <span class="op">=</span> <span class="st">"trend_non_linear"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Plot the estimates showing the peak-points</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">RRatepol</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_roc.html">plot_roc</a></span><span class="op">(</span></span>
<span>  data_source <span class="op">=</span> <span class="va">gl_roc_peaks</span>,</span>
<span>  peaks <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trend <span class="op">=</span> <span class="st">"trend_non_linear"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="workflow-example_files/figure-html/roc_figure-1.png" width="700"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ondrej Mottl.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
