<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="An R package for estimating rate of change (RoC) from community data in time series">
<title>R–Ratepol: Estimating Rate of Change in Temporal Sequences • RRatepol</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="R–Ratepol: Estimating Rate of Change in Temporal Sequences">
<meta property="og:description" content="An R package for estimating rate of change (RoC) from community data in time series">
<meta property="og:image" content="https://hope-uib-bio.github.io/R-Ratepol-package/reference/figures/RRatepol_logo.png">
<meta property="og:image:alt" content="The original sketch for logo was done by Vanesa Surtkova">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:creator" content="@OndrejMottl">
<meta name="twitter:site" content="@OndrejMottl">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">RRatepol</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/package-description.html">General RRatepol package description</a>
    <a class="dropdown-item" href="articles/workflow-example.html">Example of full workflow</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/HOPE-UIB-BIO/R-Ratepol-package/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="rratepol-package-">RRatepol package <img src="reference/figures/RRatepol_logo.png" align="right" width="200"><a class="anchor" aria-label="anchor" href="#rratepol-package-"></a>
</h1></div>
<!-- badges: start -->

<div class="section level2">
<h2 id="current-version-122">Current version: 1.2.2<a class="anchor" aria-label="anchor" href="#current-version-122"></a>
</h2>
<p>What is new in the package? See <a href="https://hope-uib-bio.github.io/R-Ratepol-package/news/index.html">NEWS</a></p>
<div class="section level3">
<h3 id="package-logo">Package logo<a class="anchor" aria-label="anchor" href="#package-logo"></a>
</h3>
<p>The original sketch for logo was done by <a href="https://www.instagram.com/vavatattoo/" class="external-link">Vanesa Surtkova</a>. Check her out!</p>
</div>
</div>
<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<p>RRatepol is an R package for estimating rate of change (RoC) from community data in time series.</p>
<p>RRatepol is written as an R package and includes a range of possible settings including a novel method to evaluate RoC in a single stratigraphical sequence using assemblage data and age uncertainties for each level. There are multiple built-in dissimilarity coefficients (dissimilarity_coefficient) for different types of assemblage data, and various levels of data smoothing that can be applied depending on the type and variance of the data. In addition, RRatepol can use randomisation, accompanied by use of age uncertainties of each level and taxon standardisation to detect RoC patterns in datasets with high data noise or variability (i.e. numerous rapid changes in composition or sedimentation rates).</p>
</div>
<div class="section level2">
<h2 id="installing-package">Installing package<a class="anchor" aria-label="anchor" href="#installing-package"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"HOPE-UIB-BIO/R-Ratepol-package"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="cite-as">Cite as<a class="anchor" aria-label="anchor" href="#cite-as"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"RRatepol"</span><span class="op">)</span></span></code></pre></div>
<p>Ondřej Mottl, John-Arvid Grytnes, Alistair W.R. Seddon, Manuel J. Steinbauer, Kuber P. Bhatta, Vivian A. Felde, Suzette G.A. Flantua, H. John B. Birks. Rate-of-change analysis in palaeoecology revisited: a new approach Review of Palaeobotany and Palynology 293, doi: <a href="https://doi.org/10.1016/j.revpalbo.2021.104483" class="external-link"><img src="https://img.shields.io/badge/doi-10.1016/j.revpalbo.2021.104483-yellow.svg"></a></p>
</div>
<div class="section level2">
<h2 id="package-website">Package website<a class="anchor" aria-label="anchor" href="#package-website"></a>
</h2>
<p>More detailed information can be found on <a href="https://hope-uib-bio.github.io/R-Ratepol-package/">RRatepol package website</a></p>
<p>This include description of the individual steps for RoC estimation <a href="https://hope-uib-bio.github.io/R-Ratepol-package/articles/package-description.html">Package Description</a></p>
</div>
<div class="section level2">
<h2 id="fossilpol">FOSSILPOL<a class="anchor" aria-label="anchor" href="#fossilpol"></a>
</h2>
<p>If you are interested in estimating rate of change for several records, please see <a href="https://hope-uib-bio.github.io/FOSSILPOL-website/" class="external-link"><strong>FOSSILPOL</strong></a>, an R-based modular workflow to process multiple fossil pollen records to create a comprehensive, standardized dataset compilation, ready for multi-record and multi-proxy analyses at various spatial and temporal scales.</p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<div class="section level3">
<h3 id="workflow">Workflow<a class="anchor" aria-label="anchor" href="#workflow"></a>
</h3>
<p>Example of workflow showing full strength of RRatepol package, with as step by step guidance starting from downloading dataset from Neotoma, building age-depth models, to estimating rate-of-change using age uncertainty. <a href="https://hope-uib-bio.github.io/R-Ratepol-package/articles/workflow-example.html">Example of full workflow</a></p>
</div>
<div class="section level3">
<h3 id="apd-r-ratepol-workshop">APD R-Ratepol workshop<a class="anchor" aria-label="anchor" href="#apd-r-ratepol-workshop"></a>
</h3>
<p>For additional examples of RRatepol setting, see <a href="https://ondrejmottl.github.io/APD_R-Ratepol_workshop/" class="external-link">Materials for R-Ratepol workshop with an African focus (APD data users)</a></p>
</div>
<div class="section level3">
<h3 id="occr-r-ratepol-workshop">OCCR R-Ratepol workshop<a class="anchor" aria-label="anchor" href="#occr-r-ratepol-workshop"></a>
</h3>
<p>For examples using other data types than fosssil pollen, see <a href="https://ondrejmottl.github.io/OCCR_R-Ratepol_workshop/" class="external-link">Oeschger Centre for Climate Change Research Workshop</a> for workflows using geochemistry and XRF data.</p>
</div>
<div class="section level3">
<h3 id="build-in-example">Build-in example<a class="anchor" aria-label="anchor" href="#build-in-example"></a>
</h3>
<p>Pollen data from four European sequences the <em>Neotoma database</em> (Goring et al., 2015) were obtained. Taxa were standardised to the taxonomically highest pollen morphotype (Level = MHVar2) using the pollen harmonisation table in Giesecke et al. (2019).</p>
<p>Age-depth models were developed using the pre-selected radiometric control points provided in Giesecke et al. (2014) and calibrated the radiocarbon dates using the IntCal13 Northern Hemisphere calibration curve (Reimer et al., 2013). For each sequence, an age-depth model was constructed using the <em>Bchron R package</em> (Haslett &amp; Parnell, 2008) to generate 1000 possible age predictions (i.e. age uncertainties) for all levels. We calculated the median of all the uncertainties for each level to give the most probable age (default age) in calibrated years before present (cal yr BP, where 0 = 1950 CE).</p>
<p>In each sequence, we excluded all levels that contained less than 150 pollen grain counts of the terrestrial taxa, and all levels beyond a 3000-years extrapolation of the oldest chronological control point. In addition, we excluded all levels with an age older than 8500 cal yr BP to focus on the period of most substantial human impact.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HOPE-UIB-BIO/R-Ratepol-package" class="external-link">RRatepol</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_data</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">RRatepol</span><span class="fu">::</span><span class="va"><a href="reference/example_data.html">example_data</a></span></span>
<span></span>
<span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">example_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; Rows: 4</span></span>
<span><span class="co">#&gt; Columns: 7</span></span>
<span><span class="co">#&gt; $ dataset_id        &lt;chr&gt; "4012", "40951", "45314", "17334"</span></span>
<span><span class="co">#&gt; $ collection_handle &lt;chr&gt; "DALLICAN", "STEERMOS", "KILOALA", "GL"</span></span>
<span><span class="co">#&gt; $ lat               &lt;dbl&gt; 60.38736, 47.80567, 67.96611, 53.00735</span></span>
<span><span class="co">#&gt; $ long              &lt;dbl&gt; -1.096480, 8.200150, 20.460278, -6.348035</span></span>
<span><span class="co">#&gt; $ pollen_data       &lt;list&gt; [&lt;tbl_df[63 x 51]&gt;], [&lt;tbl_df[273 x 104]&gt;], [&lt;tbl_df…</span></span>
<span><span class="co">#&gt; $ sample_age        &lt;named list&gt; [&lt;data.frame[63 x 3]&gt;], [&lt;data.frame[273 x 3]&gt;], [&lt;d…</span></span>
<span><span class="co">#&gt; $ age_uncertainty   &lt;named list&gt; &lt;&lt;matrix[1000 x 63]&gt;&gt;, &lt;&lt;matrix[1000 x 273]&gt;&gt;, &lt;&lt;mat…</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">example_data</span> <span class="op"><a href="reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      x <span class="op">=</span> <span class="va">long</span>,</span>
<span>      y <span class="op">=</span> <span class="va">lat</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/borders.html" class="external-link">borders</a></span><span class="op">(</span></span>
<span>    fill <span class="op">=</span> <span class="st">"gray90"</span>,</span>
<span>    colour <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="fl">0</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    shape <span class="op">=</span> <span class="fl">20</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_map.html" class="external-link">coord_quickmap</a></span><span class="op">(</span></span>
<span>    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span>,</span>
<span>    ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">47</span>, <span class="fl">70</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Latitude"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot_data-1.png"></p>
<div class="section level4">
<h4 id="example-1">Example 1<a class="anchor" aria-label="anchor" href="#example-1"></a>
</h4>
<p>Estimate RoC values for <em>Dallican Water</em> site using <em>Age-weighed smoothing</em> of the data and <em>Chord dissimilarity</em> coefficient. Pollen data will not standardised to a certain pollen count and age uncertainties from <em>Bchron</em> will not be used.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sequence_01</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">RRatepol</span><span class="fu">::</span><span class="fu"><a href="reference/estimate_roc.html">estimate_roc</a></span><span class="op">(</span></span>
<span>    data_source_community <span class="op">=</span> <span class="va">example_data</span><span class="op">$</span><span class="va">pollen_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    data_source_age <span class="op">=</span> <span class="va">example_data</span><span class="op">$</span><span class="va">sample_age</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    smooth_method <span class="op">=</span> <span class="st">"shep"</span>,</span>
<span>    dissimilarity_coefficient <span class="op">=</span> <span class="st">"chisq"</span>,</span>
<span>    working_units <span class="op">=</span> <span class="st">"levels"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; #----------------------------------------------------------#</span></span>
<span><span class="co">#&gt; ℹ RRatepol started 2023-11-24 11:35:34</span></span>
<span><span class="co">#&gt; #----------------------------------------------------------#</span></span>
<span><span class="co">#&gt; ℹ RoC will be estimated between individual subsequent levels</span></span>
<span><span class="co">#&gt; ℹ 'time_standardisation' = 500 : RoC values will be reported as disimilarity per 500 years.</span></span>
<span><span class="co">#&gt; #----------------------------------------------------------#</span></span>
<span><span class="co">#&gt; ℹ RRatepol finished 2023-11-24 11:35:35 taking 0.66 secs</span></span>
<span><span class="co">#&gt; #----------------------------------------------------------#</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">RRatepol</span><span class="fu">::</span><span class="fu"><a href="reference/plot_roc.html">plot_roc</a></span><span class="op">(</span></span>
<span>  data_source <span class="op">=</span> <span class="va">sequence_01</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot_1-1.png"></p>
</div>
<div class="section level4">
<h4 id="example-2">Example 2<a class="anchor" aria-label="anchor" href="#example-2"></a>
</h4>
<p>Now try to standardise pollen data in each sample to a maximum of 150 pollen grains and use age uncertainties from <em>age-depth model</em>. Process will be repeated 1000 times on multiple cores using parallel computation. This will produce error <em>wrapper</em> showing 95th percent quantile.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sequence_02</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">RRatepol</span><span class="fu">::</span><span class="fu"><a href="reference/estimate_roc.html">estimate_roc</a></span><span class="op">(</span></span>
<span>    data_source_community <span class="op">=</span> <span class="va">example_data</span><span class="op">$</span><span class="va">pollen_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    data_source_age <span class="op">=</span> <span class="va">example_data</span><span class="op">$</span><span class="va">sample_age</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    age_uncertainty <span class="op">=</span> <span class="va">example_data</span><span class="op">$</span><span class="va">age_uncertainty</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    smooth_method <span class="op">=</span> <span class="st">"shep"</span>,</span>
<span>    dissimilarity_coefficient <span class="op">=</span> <span class="st">"chisq"</span>,</span>
<span>    working_units <span class="op">=</span> <span class="st">"levels"</span>,</span>
<span>    standardise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    n_individuals <span class="op">=</span> <span class="fl">150</span>,</span>
<span>    rand <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    use_parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; #----------------------------------------------------------#</span></span>
<span><span class="co">#&gt; ℹ RRatepol started 2023-11-24 11:35:35</span></span>
<span><span class="co">#&gt; #----------------------------------------------------------#</span></span>
<span><span class="co">#&gt; ℹ 'age_uncertainty' will be used for in the RoC estimation</span></span>
<span><span class="co">#&gt; ℹ RoC will be estimated between individual subsequent levels</span></span>
<span><span class="co">#&gt; ℹ 'time_standardisation' = 500 : RoC values will be reported as disimilarity per 500 years.</span></span>
<span><span class="co">#&gt; ℹ Data will be standardise in each Working unit to 150 or the lowest number detected in dataset</span></span>
<span><span class="co">#&gt; #----------------------------------------------------------#</span></span>
<span><span class="co">#&gt; ℹ RRatepol finished 2023-11-24 11:35:49 taking 13.53 secs</span></span>
<span><span class="co">#&gt; #----------------------------------------------------------#</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">RRatepol</span><span class="fu">::</span><span class="fu"><a href="reference/plot_roc.html">plot_roc</a></span><span class="op">(</span></span>
<span>  data_source <span class="op">=</span> <span class="va">sequence_02</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot_2-1.png"></p>
</div>
<div class="section level4">
<h4 id="example-3">Example 3<a class="anchor" aria-label="anchor" href="#example-3"></a>
</h4>
<p>Use <em>Binning with the mowing window</em> approach with <code>bin_size</code> = 500 and <code>number_of_shifts</code> = 5.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sequence_03</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">RRatepol</span><span class="fu">::</span><span class="fu"><a href="reference/estimate_roc.html">estimate_roc</a></span><span class="op">(</span></span>
<span>    data_source_community <span class="op">=</span> <span class="va">example_data</span><span class="op">$</span><span class="va">pollen_data</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    data_source_age <span class="op">=</span> <span class="va">example_data</span><span class="op">$</span><span class="va">sample_age</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    age_uncertainty <span class="op">=</span> <span class="va">example_data</span><span class="op">$</span><span class="va">age_uncertainty</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    smooth_method <span class="op">=</span> <span class="st">"shep"</span>,</span>
<span>    dissimilarity_coefficient <span class="op">=</span> <span class="st">"chisq"</span>,</span>
<span>    working_units <span class="op">=</span> <span class="st">"MW"</span>,</span>
<span>    bin_size <span class="op">=</span> <span class="fl">500</span>,</span>
<span>    number_of_shifts <span class="op">=</span> <span class="fl">5</span>,</span>
<span>    standardise <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    n_individuals <span class="op">=</span> <span class="fl">150</span>,</span>
<span>    rand <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>    use_parallel <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; #----------------------------------------------------------#</span></span>
<span><span class="co">#&gt; ℹ RRatepol started 2023-11-24 11:35:49</span></span>
<span><span class="co">#&gt; #----------------------------------------------------------#</span></span>
<span><span class="co">#&gt; ℹ 'age_uncertainty' will be used for in the RoC estimation</span></span>
<span><span class="co">#&gt; ℹ RoC will be estimated using 'binning with the mowing window' of 500 yr time bin over 5 number of window shifts</span></span>
<span><span class="co">#&gt; ℹ Sample will randomly selected for each bin</span></span>
<span><span class="co">#&gt; ℹ 'time_standardisation' = 500 : RoC values will be reported as disimilarity per 500 years.</span></span>
<span><span class="co">#&gt; ℹ Data will be standardise in each Working unit to 150 or the lowest number detected in dataset</span></span>
<span><span class="co">#&gt; #----------------------------------------------------------#</span></span>
<span><span class="co">#&gt; ℹ RRatepol finished 2023-11-24 11:36:17 taking 27.69 secs</span></span>
<span><span class="co">#&gt; #----------------------------------------------------------#</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">RRatepol</span><span class="fu">::</span><span class="fu"><a href="reference/plot_roc.html">plot_roc</a></span><span class="op">(</span></span>
<span>  data_source <span class="op">=</span> <span class="va">sequence_03</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot_3-1.png"></p>
</div>
<div class="section level4">
<h4 id="example-4">Example 4<a class="anchor" aria-label="anchor" href="#example-4"></a>
</h4>
<p>Detect the <em>peak points</em> using <em>trend_non_linear</em> method.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sequence_03_with_peaks</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">RRatepol</span><span class="fu">::</span><span class="fu"><a href="reference/detect_peak_points.html">detect_peak_points</a></span><span class="op">(</span></span>
<span>    data_source <span class="op">=</span> <span class="va">sequence_03</span>,</span>
<span>    sel_method <span class="op">=</span> <span class="st">"trend_non_linear"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu">RRatepol</span><span class="fu">::</span><span class="fu"><a href="reference/plot_roc.html">plot_roc</a></span><span class="op">(</span></span>
<span>  data_source <span class="op">=</span> <span class="va">sequence_03_with_peaks</span>,</span>
<span>  peaks <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trend <span class="op">=</span> <span class="st">"trend_non_linear"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot_4-1.png"></p>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/HOPE-UIB-BIO/R-Ratepol-package/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing RRatepol</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Ondrej Mottl <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=RRatepol" class="external-link"><img src="https://www.r-pkg.org/badges/version/RRatepol.png" alt="CRAN status"></a></li>
<li><a href="https://github.com/HOPE-UIB-BIO/R-Ratepol-package/actions" class="external-link"><img src="https://github.com/HOPE-UIB-BIO/R-Ratepol-package/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ondrej Mottl.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
